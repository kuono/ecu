# Changelog for MyEcu

## Unreleased changes

ライブラリとはいえ，ほとんど本体プログラムと化している。もう少し整理しないとね。

# 動作の前提条件: 

   1) ECUと接続するシリアルケーブルがあること。なければ作ること。
   2) シリアル-USB変換ケーブルがあること。なければ作ること。
   3) 変換ケーブルのドライバをインストールすること。
 ちなみに魚野は FTDI Chips の変換基盤を使用。 VCPドライバをインストールした。　https://www.ftdichip.com/Drivers/VCP.htm
-- # インストールの途中，機能拡張がブロックされるので，セキュリティとプライバシーで実行を許可すること
-- # 
-- # Change history
-- #   2018.10.14 デバイスが存在しない場合にその旨表示する。unknown データをすべて表示する。
--                異常・正常結果を常に表示。ログファイル書き込みと画面表示の両方を用意。
-- #   2018.11.11 v.0.2.0.1 マルチスレッド化->logが書き込まれない。Chanにデータが入っていかない？
-- #   2018.11.12 v.0.2.0.2 例外処理が使いこなせずコンパイルが通らないのでEither Error DataQQに。
-- #   2018.11.16 v.0.2.0.3 tryなどを使ってみる 
-- #   2018.11.16 v.0.2.0.4 MVarなど導入。並列化。
-- #    なぜかputStrだと画面が更新されない->putStrLnに
-- #    単純にCommunicatorとLoggerをforkするとloggerが先に始まってしまうことの対策
-- #      -> Chan (MVar ECUStatus)で解決
-- #    E80, E7D 時のスレッド再起動処理を埋め込む
-- #    hscurses化 -> ウィンドウの大きさを超えて画面出力すると例外が起こるので，一旦利用中止。
-- #   2018.11.16 v.0.2.0.5 キー入力でrunwithecuに非同期例外を投げるとエンジンが瞬停する。
-- #    手抜きのモデルデータ表示をやめる
-- #   2018.12.13 v.0.2.0.6 累積データを表示させるようにするため，新たにデータ型を追加し，関数引数の変更等を行う。
-- #    突然電源ECUから反応がなくなった場合のエラー処理
-- #    ND , NC エラーときの自動待機・接続挑戦継続
-- #    error code reset command 
-- #    これらのエラー処理を，Monadを使ってログに書き込んでいく
-- #    画面表示でログを表示する
-- #    エラーを表示した後，復帰しない（catch処理を組み込み）
-- #   2018.12.25 v.0.2.0.7  不要な試行錯誤コード整理
-- #                         default log directory setting in command line arg
-- #   2019.01.02 v.0.2.0.8  最小・最大データを記録・表示するように                    
-- #   2019.01.27 v.0.2.0.9  通し番号も表示するように
-- #   2019.01.29 v.0.2.0.10 接続がおかしくなった。原因は？？？←１本カプラが外れていた。→ケーブルコネクタを固定できるカップラーに変更
-- #                         エンジン速度を基準に，エラーを画面ログ部分に蓄積表示していたが，上限値超えのみ表示に。将来的には機械学習におきかえる？
-- #                         一度エラーが出ると接続がおかしくなる。例外のマスキングを正しく行うこと。
-- #                         初期化が成功したら一旦画面をクリアする。
-- #                         状態遷移をきちんと制御する。-> 例外をやめ，メッセージ化した
-- #                         動作中にケーブルを引っこ抜くと，Index例外が発生。デバイスも見つけられなくなる。
-- #                             →標準長に満たないデータ来たときはエラー処理する
-- #                         未接続状態でqを押してもQuitできない？
-- #                         throttle pot metorの値がおかしい（0.28〜3.33）→100倍していたのを10倍に
-- #                         E80,E7D 直後に初期化できない。読み込みバッファにデータ残っていそう。
-- #                         
-- #                         Post process for average caliculation and defect detection
-- #                         ライブラリ化・絞り込み（Chan ECUDataを輸出）
-- #                         threepenny.gui を使ったデータ履歴表示
-- #                         データソースの属性を記述する方式に変更（Stream/Cell, Retry/STOP, ....) 
-- #                         ん？それってFRP？でも失敗時の振る舞いを加味する操作は入っていないかも
-- #                         q で抜ける時，logger にフラッシュさせる
-- #   2019.02.19 v.0.2.1.0  一旦，安定版とする。
-- #   2019.03.09 v.0.2.1.1  テストデータモード追加。以降，GitHubにプロジェクト登録
-- #   2019.02.10 v.0.3.0.0  GUI 準備 (Threepenny-guiの導入)　とりあえず動いたが，終了方法未詳。
-- # 
-- # Future Plan
-- #   Parser モナド導入
-- #   GUIをきちんと終了させる。
-- #   FRP化する
-- #   ゲージUIを組み込む
-- #   CUIとGUIを選べるようにする
-- #   cef3を組み込み，GUIを内在化
-- #   parse関数で-- 二バイトデータを無視しているので注意
-- #   最大値・最小値を，直近10秒程度の範囲に変更する？

